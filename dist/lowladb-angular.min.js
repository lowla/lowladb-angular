/*! lowladb-angular 2015-Apr-02 */
!function(a){"use strict";function b(a){return function(b){var c=a.defer();return b.then(c.resolve,c.reject),c.promise}}function c(a,b,c,d,e,f){function g(h,i){function j(a){a.toArray().then(function(a){b(function(){l.$data.length=0,l.$data.push.apply(l.$data,a)})})}function k(a){var b=l.$data;if(angular.isNumber(a)&&a>=0&&a<b.length)return l.$data[a];if(angular.isObject(a)&&angular.isDefined(a._id)){for(var c=-1,d=0,e=b.length;e>d;d++)if(b[d]._id===a._id){c=d;break}if(-1!==c)return b[c]}return null}if(!(this instanceof g))return new g(h,i);var l=this;this.$defer=f,this.$data=[],i=i||e;var m=d.utils.debounce(j,10);return h&&(this.$off=h.on(function(b,c){b?a.warn("LowlaDBArray: cursor error "+b):m(c)}),i&&this.$off&&i.$on("$destroy",this.$off),this.$data.$add=function(a){return f(h._collection.insert(a))},this.$data.$remove=function(a){var b=k(a);return b?f(h._collection.remove({_id:b._id})):c.reject("Invalid document or index")},this.$data.$save=function(a){var b=k(a);return b?f(h._collection.findAndModify({_id:b._id},a)):c.reject("Invalid document or index")}),this.$data}return g}angular.module("lowladb",[]).value("LowlaDB",a.LowlaDB).factory("$lowlaArray",c).factory("$lowlaDefer",b),b.$inject=["$q"],c.$inject=["$log","$timeout","$q","LowlaDB","$rootScope","$lowlaDefer"]}(window);